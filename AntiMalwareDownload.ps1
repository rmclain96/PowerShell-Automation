<#  
.SYNOPSIS  
    Downloads the most recent versions of Anti-Malware and System Cleaning software
.DESCRIPTION  
    Downloads the most recent versions of Anti-Malware and System Cleaning software. This is used to easily update a common repository for us to use locally to have consistantly up-to-date tools
.NOTES  
    File Name  : AntiMalwareDownload.ps1  
    Author     : Ryan L. McLain - rmclain@ilstu.edu
    Date last revised: 11/16/2021
#>

#FilePath for the workdir
$FilePath = "C:\TechZone\"
$MBAMDownload = "https://downloads.malwarebytes.com/file/mb-windows"
$MBAMdestination = "$FilePath\mbam.exe"

Function GET-MBAM(){

    # Check if work directory exists, if not, creates it
    If (Test-Path -Path $FilePath -PathType Container)
    { Write-Host "$FilePath already exists" -ForegroundColor Red}
    ELSE
    { New-Item -Path $FilePath  -ItemType directory }

    # Download the installer
    # Check if Invoke-Webrequest exists otherwise execute WebClient
    if (Get-Command 'Invoke-Webrequest')
    {
        Invoke-WebRequest $MBAMDownload -OutFile $MBAMdestination
    }
    else
    {
        $WebClient = New-Object System.Net.WebClient
        $webclient.DownloadFile($MBAMDownload, $MBAMdestination)
    }
}